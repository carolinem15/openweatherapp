<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Weather Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="style.css">
    <!-- <script src="script.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <h1 class="display-4">Weather Dashboard</h1>
            <p class="lead">Search your city.</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-4 no-gutters" id="rightCol">
            <div class="card" style="width: 30rem;">
                <div class="card-header bg-transparent">
                    <h4 class="text-center">Search for a city:</h4>
                    <!-- Search form -->
                    <form class="form-inline d-flex justify-content-center md-form form-sm active-cyan-2 mt-2">
                        <input class="form-control form-control-sm mr-3 w-75" id="cityForm" type="text"
                            placeholder="Search" aria-label="Search">
                        <button class="button"><i class="fa fa-search" aria-hidden="true"></i></button>
                    </form>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item" id="slot"></li>
                    <li class="list-group-item" id="slot2"></li>
                    <li class="list-group-item" id="slot3"></li>
                </ul>
            </div>
        </div>
        <div class="col-sm-8 no-gutters" id="leftCol">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title" id="cityTitle">Title<img id="wIcon" src="" alt="Weather icon"></h4>
                    <p class="card-text">Temperature: </p>
                    <p id="temperature"></p>
                    <p class="card-text">Humidity: </p>
                    <p id="humidity"></p>
                    <p class="card-text">Wind Speed: </p>
                    <p id="windSpeed"></p>
                    <p class="card-text">UV Index: </p>
                    <p id="uvIndex"></p>
                </div>
                <div class="card-footer bg-transparent">
                    <div class="container">
                        <div class="row">
                            <div class="col-auto">
                                <div class="card-body-F">
                                    <h4 class="card-title">Date</h4>
                                    <i class="icon"></i>
                                    <p id="temperatureF"></p>
                                    <p id="humidityF"></p>
                                </div>
                            </div>
                            <div class="col-auto">
                                <div class="card-body-F">
                                    <h4 class="card-title">Date</h4>
                                    <i class="icon"></i>
                                    <p id="temperatureF"></p>
                                    <p id="humidityF"></p>
                                </div>
                            </div>
                            <div class="col-auto">
                                <div class="card-body-F">
                                    <h4 class="card-title">Date</h4>
                                    <i class="icon"></i>
                                    <p id="temperatureF"></p>
                                    <p id="humidityF"></p>
                                </div>
                            </div>
                            <div class="col-auto">
                                <div class="card-body-F">
                                    <h4 class="card-title">Date</h4>
                                    <i class="icon"></i>
                                    <p id="temperatureF"></p>
                                    <p id="humidityF"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {     
            buildOneUrl()
            function buildOneUrl(lat, lon) {
                var queryURL = buildQueryURL()
                // must make an AJAX call within this function to grab lat and lon values for the api call
                $.ajax({
                    url: queryURL,
                    method: "GET"
                }).then(function (response) {
                    console.log(response);
                    // grabbing value of lat and long
                    const lat = response.coord.lat
                    console.log(lat)
                    const lon = response.coord.lon
                    console.log(lon)
                });
                // having trouble creating a global variable of lat and lon
                var apiKey = "&appid=" + "0a11ae9ecf201b12ae3c0e4c0e88ff2f"
                var oneUrl = "https://api.openweathermap.org/data/2.5/onecall?lat=" + lat +
                    "&lon=" + lon + "&exclude=hourly" + apiKey
                return oneUrl;
                console.log(oneUrl)
            }

            function buildQueryURL() {
                // grabbing value of form input
                var city = $("#cityForm").val()
                console.log(city)
                var apiKey = "&appid=" + "0a11ae9ecf201b12ae3c0e4c0e88ff2f"
                var queryURL = "http://api.openweathermap.org/data/2.5/weather?q=" + city +
                    "&units=imperial" +
                    apiKey
                return queryURL;
                console.log(queryURL)
                // $.ajax({
                //     url: queryURL,
                //     method: "GET"
                // }).then(function (response) {
                //     console.log(response);
                //     // grabbing value of lat and long
                //     const lat = response.coord.lat
                //     console.log(lat)
                //     const lon = response.coord.lon
                //     console.log(lon)
                // });
            }

            // click event that passes in a parameter "btnClick" to represent the event to the click handler
            $(".button").click(function (btnClick) {
                console.log("clicked")
                var oneUrl = buildOneUrl()
                $.ajax({
                    url: oneUrl,
                    method: "GET"
                }).then(function (response) {
                    console.log(response);
                });

                //  grabbing the necessary information off of the array and rendering onto browser

                // var temp = response.main.temp
                // console.log(temp)
                // $("#temperature").text(temp + "Â°F");
                // var humidity = response.main.humidity
                // console.log(humidity)
                // $("#humidity").text(humidity + "%");
                // var windSpeed = response.wind.speed
                // console.log(windSpeed)
                // $("#windSpeed").text(windSpeed + "MPH");

                // // grabbing the city you just searched and the date of this forecast for the header -- this code below is new
                // // and hasn't been tested

                // var city = $("#cityForm").val()
                // console.log(city)

                // var cityTitle = response.lastupdate.value
                // console.log(cityTitle)
                // $("#cityTitle").text(cityTitle + "MPH");

                // // grabbing icon info

                // var icon = response.weather[0].icon
                // console.log(icon)
                // var iconURL = "http://openweathermap.org/img/w/" + icon + ".png";
                // $('#wIcon').attr('src', iconURL)
                // $("#icon").text(icon);

                // // grabbing coordinates for UV index -- this code was before i did the onecall

                // var lat = response.coord.lat
                // console.log(lat)
                // var lon = response.coord.lon
                // console.log(lon)
                //     });
                // });

// my thought here is to create an empty array and push the city searches to the array, then render them into each "slot"
// i also need to display the city and current date in the title heading

                // function searchHistory() {
                //     var searches = []
                //     var city = $("#cityForm").val()
                //     searches.push(city)
                //     console.log(searches)
                //     localStorage("searches") = $.getJSON(searches)
                //     document.getElementById("slot").innerHTML = localStorage.getItem(searches);
                // }

                // stops form from submitting back to itself
                btnClick.preventDefault();

            });
        });
    </script>
</body>

</html>